---
title: "Architecture"
description: "RAPS microkernel architecture"
section: "getting-started"
order: 3
icon: "üèóÔ∏è"
---

# Architecture

RAPS follows a **microkernel architecture** inspired by Unix OS design principles, enabling security, testability, and independent feature evolution.

## Design Philosophy

The microkernel architecture separates RAPS into:

1. **Minimal Kernel**: Core functionality is small, audited, and battle-tested
2. **Message Passing**: Components communicate through well-defined interfaces
3. **Isolation**: Failures in extensions don't crash the kernel
4. **Extensibility**: Features added via plugins, not kernel modifications
5. **Security**: Attack surface minimized in the trusted kernel

## Architecture Layers

<div class="not-prose my-8">
  {/* User Interfaces Layer */}
  <div class="relative">
    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">User Interfaces</div>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 p-4 bg-slate-800/50 rounded-lg border border-slate-700">
      <div class="flex flex-col items-center p-3 bg-slate-900 rounded-md border border-slate-600 hover:border-blue-500/50 transition-colors">
        <span class="text-sm font-semibold text-white">CLI</span>
        <span class="text-xs text-slate-400">clap</span>
      </div>
      <div class="flex flex-col items-center p-3 bg-slate-900 rounded-md border border-slate-600 hover:border-purple-500/50 transition-colors">
        <span class="text-sm font-semibold text-white">MCP Server</span>
        <span class="text-xs text-slate-400">rmcp</span>
      </div>
      <div class="flex flex-col items-center p-3 bg-slate-900 rounded-md border border-slate-600 hover:border-green-500/50 transition-colors">
        <span class="text-sm font-semibold text-white">GitHub Action</span>
        <span class="text-xs text-slate-400">yaml</span>
      </div>
      <div class="flex flex-col items-center p-3 bg-slate-900 rounded-md border border-slate-600 hover:border-cyan-500/50 transition-colors">
        <span class="text-sm font-semibold text-white">Docker</span>
        <span class="text-xs text-slate-400">container</span>
      </div>
      <div class="flex flex-col items-center p-3 bg-slate-900 rounded-md border border-slate-600 hover:border-amber-500/50 transition-colors">
        <span class="text-sm font-semibold text-white">TUI</span>
        <span class="text-xs text-slate-400">ratatui</span>
      </div>
    </div>
  </div>

  {/* Arrow Down */}
  <div class="flex justify-center my-2">
    <svg class="w-6 h-6 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
    </svg>
  </div>

  {/* RAPS Application Layer */}
  <div class="relative">
    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">RAPS Application</div>
    <div class="p-4 bg-gradient-to-b from-blue-900/30 to-blue-950/30 rounded-lg border border-blue-800/50">
      <div class="flex flex-col sm:flex-row gap-3 justify-center items-center">
        <div class="flex flex-col items-center p-4 bg-slate-900 rounded-md border border-blue-600/50 min-w-[160px]">
          <span class="text-sm font-bold text-blue-400">raps</span>
          <span class="text-xs text-slate-400">Main Application</span>
        </div>
        <svg class="w-5 h-5 text-slate-500 rotate-90 sm:rotate-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
        <div class="flex flex-col items-center p-4 bg-slate-900 rounded-md border-2 border-amber-500/50 min-w-[160px]">
          <span class="text-sm font-bold text-amber-400">raps-kernel</span>
          <span class="text-xs text-slate-400">Core Kernel</span>
        </div>
      </div>
    </div>
  </div>

  {/* Arrow Down */}
  <div class="flex justify-center my-2">
    <svg class="w-6 h-6 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
    </svg>
  </div>

  {/* Service Crates Layer */}
  <div class="relative">
    <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Service Crates</div>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 p-4 bg-slate-800/50 rounded-lg border border-slate-700">
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-oss</code>
      </div>
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-derivative</code>
      </div>
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-dm</code>
      </div>
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-da</code>
      </div>
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-acc</code>
      </div>
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-webhooks</code>
      </div>
      <div class="flex items-center justify-center p-3 bg-slate-900 rounded-md border border-emerald-600/30 hover:border-emerald-500/50 transition-colors">
        <code class="text-xs text-emerald-400">raps-reality</code>
      </div>
    </div>
  </div>
</div>

## Kernel (`raps-kernel`)

The kernel is the minimal trusted foundation that all features build upon.

**Contents:**
- Authentication (OAuth2, SSA, token management)
- HTTP client (with retry logic and middleware)
- Configuration management
- Secure credential storage (OS keyring)
- Domain types (URN, BucketKey, ObjectKey)
- Error handling with exit codes
- Logging with secret redaction

**Constraints:**
- **Size**: Less than 3000 lines of code (target: ~2000 LOC)
- **Safety**: `#![deny(unsafe_code)]`, `#![deny(clippy::unwrap_used)]`
- **Test Coverage**: Greater than 90% on critical paths
- **Dependencies**: Minimal external dependencies

**Build Performance:**
- Incremental check: Less than 5s
- Full build: Less than 30s

## Service Crates

Service crates provide APS API functionality:

- **`raps-oss`**: Object Storage Service (buckets, objects, uploads, downloads)
- **`raps-derivative`**: Model Derivative API (translations, manifests, derivatives)
- **`raps-dm`**: Data Management API (hubs, projects, folders, items, versions)
- **`raps-da`**: Design Automation API (engines, activities, work items)
- **`raps-acc`**: ACC/BIM 360 (issues, RFIs, assets, submittals, checklists)
- **`raps-webhooks`**: Webhooks API (subscriptions, events, verification)
- **`raps-reality`**: Reality Capture API (photoscenes, processing, results)

**Service Principles:**
- Depend only on `raps-kernel`, not on each other
- Independent failure domains
- Can be tested in isolation
- Can evolve independently

## Features

RAPS provides comprehensive coverage of Autodesk Platform Services APIs:

### Core Services
- **Authentication**: 2-legged OAuth, 3-legged OAuth, Device Code Flow, SSA (Secure Service Accounts)
- **Object Storage (OSS)**: Bucket CRUD, Object CRUD, Parallel Uploads, Signed URLs (S3)
- **Model Derivative**: Translation Jobs, Status & Manifest, Derivative Download
- **Data Management**: Hubs & Projects, Folders & Items, Tip Version & Derivatives

### Extended Features
- **Account Admin API**: Account management and administration
- **ACC Modules**: Issues, RFIs, Assets, Submittals, Checklists
- **Design Automation**: Engines, Activities, Work Items management
- **Reality Capture**: Photogrammetry processing capabilities
- **Webhooks**: Event subscriptions and workflow automation
- **Pipelines**: YAML/JSON workflow automation
- **Plugins**: Extend functionality with custom commands
- **MCP Server**: AI assistant integration via Model Context Protocol
- **TUI**: Terminal user interface for interactive operations

## Build Commands

```bash
# Standard build (includes all features)
cargo build

# Minimal build (kernel + core services only)
cargo build --no-default-features --features core
```

## Version Output

```bash
$ raps --version
raps 3.9.0
```

## Performance Targets

RAPS is optimized for fast development feedback loops:

| Metric | Target | Measurement |
|--------|--------|-------------|
| Kernel check (incremental) | Less than 5s | After single file change |
| Workspace check (incremental) | Less than 30s | After single file change |
| CLI startup (`--help`) | Less than 100ms | Cold start |
| File upload (100MB, parallel) | Less than 30s | Network dependent (100Mbps) |
| MCP tool call | Less than 200ms | AI assistant integration |

**Build Tooling:**
- **Windows**: `lld-link` linker (via LLVM)
- **Linux**: `mold` linker (in CI)
- **All platforms**: `sccache` for compilation caching, `cargo-nextest` for parallel tests

See [Development Setup](/docs/development) for local configuration.

## Benefits

**Security:**
- Minimal attack surface in kernel
- Independent security auditing of services
- Clear security boundaries

**Testability:**
- Kernel can be tested in isolation
- Services can be mocked for integration tests
- High test coverage achievable

**Maintainability:**
- Clear separation of concerns
- Independent evolution of features
- Easier code reviews

**Performance:**
- Fast incremental builds
- Parallel test execution
- Optimized linker usage

**Business Model:**
- Core functionality remains open source
- Enterprise features enable sustainable development
- Clear upgrade path for users
