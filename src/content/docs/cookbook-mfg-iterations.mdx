---
title: "Design Iteration Tracking"
description: "Organize CAD files by revision for design tracking"
section: "cookbook"
order: 24
icon: "üîÅ"
---

# Design Iteration Tracking

Organize CAD files by revision and track design changes over time.

## Workflow Overview

<div class="not-prose my-8">
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="border-2 border-blue-500/50 rounded-lg p-4 bg-blue-500/10">
      <div class="text-blue-400 font-semibold text-sm mb-3">Naming Convention</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1 font-mono">parts/&#123;part-number&#125;/&#123;revision&#125;/file.ipt</div>
    </div>
    <div class="border-2 border-amber-500/50 rounded-lg p-4 bg-amber-500/10">
      <div class="text-amber-400 font-semibold text-sm mb-3">OSS Structure</div>
      <div class="space-y-1 text-xs text-slate-300 font-mono">
        <div class="bg-slate-800 rounded px-2 py-1">parts/12345/rev-A/part.ipt</div>
        <div class="bg-slate-800 rounded px-2 py-1">parts/12345/rev-B/part.ipt</div>
        <div class="bg-slate-800 rounded px-2 py-1">parts/12345/rev-C/part.ipt</div>
        <div class="bg-slate-800 rounded px-2 py-1">parts/12345/latest/part.ipt</div>
      </div>
    </div>
    <div class="border-2 border-purple-500/50 rounded-lg p-4 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-sm mb-3">Translation</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">SVF2 rev-A</div>
        <div class="bg-slate-800 rounded px-2 py-1">SVF2 rev-B</div>
        <div class="bg-slate-800 rounded px-2 py-1">SVF2 rev-C</div>
      </div>
    </div>
    <div class="border-2 border-emerald-500/50 rounded-lg p-4 bg-emerald-500/10">
      <div class="text-emerald-400 font-semibold text-sm mb-3">Comparison</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Property Diff</div>
        <div class="bg-slate-800 rounded px-2 py-1">Geometry Change</div>
      </div>
    </div>
  </div>
  <div class="flex justify-center mt-4">
    <div class="flex items-center gap-2 text-xs text-slate-500">
      <span>Convention</span>
      <span class="text-slate-600">‚Üí</span>
      <span>Storage</span>
      <span class="text-slate-600">‚Üí</span>
      <span>Translate</span>
      <span class="text-slate-600">‚Üí</span>
      <span>Compare</span>
    </div>
  </div>
</div>

---

## CLI Approach

### Step 1: Upload with Revision Metadata

```bash
PART_NUMBER="12345"
REVISION="rev-B"

# Upload with structured key
raps object upload cad-library part.ipt --key "parts/${PART_NUMBER}/${REVISION}/part.ipt"

# Also update "latest" reference
raps object upload cad-library part.ipt --key "parts/${PART_NUMBER}/latest/part.ipt"
```

### Step 2: List All Revisions

```bash
PART_NUMBER="12345"

raps object list cad-library --prefix "parts/${PART_NUMBER}/" --output json | \
  jq -r '.[] | .key' | sort

# Output:
# parts/12345/latest/part.ipt
# parts/12345/rev-A/part.ipt
# parts/12345/rev-B/part.ipt
# parts/12345/rev-C/part.ipt
```

### Step 3: Compare Revisions

```bash
# Get URNs for two revisions
REV_A_URN=$(raps object urn cad-library "parts/12345/rev-A/part.ipt" --output plain)
REV_B_URN=$(raps object urn cad-library "parts/12345/rev-B/part.ipt" --output plain)

# Extract properties for comparison
raps derivative properties "$REV_A_URN" --output json > rev-a-props.json
raps derivative properties "$REV_B_URN" --output json > rev-b-props.json

# Compare key properties
echo "Revision Comparison:"
echo "===================="

for prop in "Mass" "Volume" "Material"; do
  VAL_A=$(jq -r ".[0].properties[\"$prop\"] // \"N/A\"" rev-a-props.json)
  VAL_B=$(jq -r ".[0].properties[\"$prop\"] // \"N/A\"" rev-b-props.json)

  if [ "$VAL_A" != "$VAL_B" ]; then
    echo "$prop: $VAL_A ‚Üí $VAL_B (CHANGED)"
  else
    echo "$prop: $VAL_A (unchanged)"
  fi
done
```

### Step 4: Generate Revision History Report

```bash
PART_NUMBER="12345"

echo "# Revision History: Part $PART_NUMBER" > revision-history.md
echo "" >> revision-history.md

raps object list cad-library --prefix "parts/${PART_NUMBER}/rev-" --output json | \
  jq -r '.[] | .key' | sort | while read key; do
    REV=$(echo "$key" | grep -oP 'rev-\w+')
    DATE=$(raps object list cad-library --prefix "$key" --output json | jq -r '.[0].lastModified')

    URN=$(raps object urn cad-library "$key" --output plain)
    MASS=$(raps derivative properties "$URN" --output json 2>/dev/null | jq -r '.[0].properties.Mass // "N/A"')

    echo "## $REV" >> revision-history.md
    echo "- Date: $DATE" >> revision-history.md
    echo "- Mass: $MASS" >> revision-history.md
    echo "" >> revision-history.md
  done
```

---

## CI/CD Pipeline

```yaml
# .github/workflows/design-iterations.yml
name: Design Iteration Tracking

on:
  push:
    paths:
      - 'parts/**/*.ipt'
      - 'parts/**/*.iam'

jobs:
  track-iterations:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Full history for comparison

      - name: Install RAPS
        run: cargo install raps

      - name: Upload new revisions
        env:
          APS_CLIENT_ID: ${{ secrets.APS_CLIENT_ID }}
          APS_CLIENT_SECRET: ${{ secrets.APS_CLIENT_SECRET }}
        run: |
          BUCKET="design-iterations"
          REVISION="rev-$(date +%Y%m%d)"

          for file in $(git diff --name-only HEAD~1 HEAD -- 'parts/**'); do
            [ -f "$file" ] || continue

            # Extract part number from path (parts/XXXXX/file.ipt)
            PART_NUM=$(echo "$file" | cut -d'/' -f2)
            FILENAME=$(basename "$file")

            # Upload versioned
            raps object upload "$BUCKET" "$file" --key "parts/${PART_NUM}/${REVISION}/${FILENAME}"

            # Upload as latest
            raps object upload "$BUCKET" "$file" --key "parts/${PART_NUM}/latest/${FILENAME}"

            echo "Uploaded: $PART_NUM $REVISION"
          done

      - name: Translate latest revisions
        env:
          APS_CLIENT_ID: ${{ secrets.APS_CLIENT_ID }}
          APS_CLIENT_SECRET: ${{ secrets.APS_CLIENT_SECRET }}
        run: |
          for file in $(git diff --name-only HEAD~1 HEAD -- 'parts/**'); do
            [ -f "$file" ] || continue

            PART_NUM=$(echo "$file" | cut -d'/' -f2)
            FILENAME=$(basename "$file")

            URN=$(raps object urn design-iterations "parts/${PART_NUM}/latest/${FILENAME}" --output plain)
            raps translate start "$URN" --format svf2 --wait
          done

      - name: Generate comparison report
        env:
          APS_CLIENT_ID: ${{ secrets.APS_CLIENT_ID }}
          APS_CLIENT_SECRET: ${{ secrets.APS_CLIENT_SECRET }}
        run: |
          echo "# Design Change Report" > change-report.md
          echo "Commit: ${{ github.sha }}" >> change-report.md
          echo "" >> change-report.md

          # Add comparison logic here

      - name: Upload report
        uses: actions/upload-artifact@v4
        with:
          name: design-change-report
          path: change-report.md
```

### Pipeline Flow

<div class="not-prose my-6">
  <div class="flex flex-col sm:flex-row items-stretch gap-3">
    <div class="flex-1 border-2 border-blue-500/50 rounded-lg p-3 bg-blue-500/10">
      <div class="text-blue-400 font-semibold text-xs mb-2">Git Push</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">Part files changed</div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">‚Üí</div>
    <div class="flex-1 border-2 border-amber-500/50 rounded-lg p-3 bg-amber-500/10">
      <div class="text-amber-400 font-semibold text-xs mb-2">Versioning</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Generate revision ID</div>
        <div class="bg-slate-800 rounded px-2 py-1">Upload rev-YYYYMMDD</div>
        <div class="bg-slate-800 rounded px-2 py-1">Update latest</div>
      </div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">‚Üí</div>
    <div class="flex-1 border-2 border-purple-500/50 rounded-lg p-3 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-xs mb-2">Processing</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Translate latest</div>
        <div class="bg-slate-800 rounded px-2 py-1">Compare with previous</div>
      </div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">‚Üí</div>
    <div class="flex-1 border-2 border-emerald-500/50 rounded-lg p-3 bg-emerald-500/10">
      <div class="text-emerald-400 font-semibold text-xs mb-2">Report</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">change-report.md</div>
    </div>
  </div>
</div>

---

## MCP Integration

### Track New Revision

```
User: "Upload the updated bracket design as rev-C and compare it with rev-B"
```

<div class="not-prose my-6">
  <div class="bg-slate-900/50 rounded-lg border border-slate-700 p-4">
    <div class="flex gap-4 mb-4 text-xs font-semibold">
      <div class="text-blue-400">User</div>
      <div class="text-purple-400">AI Assistant</div>
      <div class="text-amber-400">RAPS MCP</div>
      <div class="text-emerald-400">APS Cloud</div>
    </div>
    <div class="space-y-2 text-xs">
      <div class="flex items-center gap-2">
        <div class="w-16 text-blue-400">User</div>
        <div class="flex-1 border-t border-dashed border-purple-500"></div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">Upload rev-C and compare with rev-B</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_object_upload(key="parts/12345/rev-C/bracket.ipt")</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">Upload</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-emerald-400">APS</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">Complete</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_translate_start(rev-C URN)</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">Translate</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_derivative_properties(rev-B URN)</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_derivative_properties(rev-C URN)</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">Compare properties</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-blue-500"></div>
        <div class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded">Comparison report</div>
      </div>
    </div>
  </div>
</div>

**AI Response:**
> Uploaded bracket.ipt as rev-C and compared with rev-B:
>
> **Property Changes:**
> | Property | Rev-B | Rev-C | Change |
> |----------|-------|-------|--------|
> | Mass | 1.25 kg | 1.18 kg | -5.6% |
> | Volume | 456 cm¬≥ | 432 cm¬≥ | -5.3% |
> | Material | Al 6061 | Al 6061 | - |
>
> **Summary:** Weight reduction of 70g achieved through geometry optimization.

### List Revision History

```
User: "Show me all revisions of part 12345"
```

**AI Response:**
> Revision History for Part 12345:
>
> | Revision | Date | Mass | Status |
> |----------|------|------|--------|
> | rev-C | Feb 15, 2024 | 1.18 kg | Current |
> | rev-B | Feb 01, 2024 | 1.25 kg | Superseded |
> | rev-A | Jan 15, 2024 | 1.32 kg | Superseded |
>
> **Notes:**
> - rev-B ‚Üí rev-C: Weight optimization
> - rev-A ‚Üí rev-B: Material change

---

## Best Practices

### Naming Convention

```
bucket/
‚îî‚îÄ‚îÄ parts/
    ‚îî‚îÄ‚îÄ {part-number}/
        ‚îú‚îÄ‚îÄ rev-A/
        ‚îÇ   ‚îî‚îÄ‚îÄ {part-name}.ipt
        ‚îú‚îÄ‚îÄ rev-B/
        ‚îÇ   ‚îî‚îÄ‚îÄ {part-name}.ipt
        ‚îú‚îÄ‚îÄ rev-C/
        ‚îÇ   ‚îî‚îÄ‚îÄ {part-name}.ipt
        ‚îî‚îÄ‚îÄ latest/
            ‚îî‚îÄ‚îÄ {part-name}.ipt
```

### Revision Comparison Script

```bash
#!/bin/bash
# compare-revisions.sh

BUCKET=$1
PART=$2
REV_OLD=$3
REV_NEW=$4

OLD_URN=$(raps object urn "$BUCKET" "parts/$PART/$REV_OLD/*.ipt" --output plain)
NEW_URN=$(raps object urn "$BUCKET" "parts/$PART/$REV_NEW/*.ipt" --output plain)

echo "Comparing $PART: $REV_OLD vs $REV_NEW"
echo "======================================="

# Get properties
raps derivative properties "$OLD_URN" --output json > /tmp/old.json
raps derivative properties "$NEW_URN" --output json > /tmp/new.json

# Compare
diff <(jq -S '.[0].properties' /tmp/old.json) <(jq -S '.[0].properties' /tmp/new.json)
```

---

## Related

- [CAD Translation Pipeline](/docs/cookbook-mfg-translation)
- [Bill of Materials Extraction](/docs/cookbook-mfg-bom)
- [Cookbook: Manufacturing](/docs/cookbook-manufacturing)
