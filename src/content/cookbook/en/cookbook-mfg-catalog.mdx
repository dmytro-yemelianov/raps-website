---
title: "Thumbnail Catalog Generation"
description: "Build visual catalogs of parts with thumbnails"
category: "manufacturing"
order: 27
icon: "üñºÔ∏è"
---

# Thumbnail Catalog Generation

Create visual catalogs of CAD parts with auto-generated thumbnails.

## Workflow Overview

<div class="not-prose my-8">
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="border-2 border-blue-500/50 rounded-lg p-4 bg-blue-500/10">
      <div class="text-blue-400 font-semibold text-sm mb-3">CAD Library</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">Parts Collection</div>
    </div>
    <div class="border-2 border-purple-500/50 rounded-lg p-4 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-sm mb-3">Processing</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Translate to SVF2</div>
        <div class="bg-slate-800 rounded px-2 py-1">Extract Thumbnails</div>
        <div class="bg-slate-800 rounded px-2 py-1">Extract Metadata</div>
      </div>
    </div>
    <div class="border-2 border-purple-500/50 rounded-lg p-4 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-sm mb-3">Catalog Generation</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Create Thumbnail Grid</div>
        <div class="bg-slate-800 rounded px-2 py-1">Build Index Page</div>
        <div class="bg-slate-800 rounded px-2 py-1">Generate Search Data</div>
      </div>
    </div>
    <div class="border-2 border-emerald-500/50 rounded-lg p-4 bg-emerald-500/10">
      <div class="text-emerald-400 font-semibold text-sm mb-3">Catalog Output</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">HTML Gallery</div>
        <div class="bg-slate-800 rounded px-2 py-1">JSON Index</div>
        <div class="bg-slate-800 rounded px-2 py-1">PDF Catalog</div>
      </div>
    </div>
  </div>
  <div class="flex justify-center mt-4">
    <div class="flex items-center gap-2 text-xs text-slate-500">
      <span>Input</span>
      <span class="text-slate-600">‚Üí</span>
      <span>Process</span>
      <span class="text-slate-600">‚Üí</span>
      <span>Generate</span>
      <span class="text-slate-600">‚Üí</span>
      <span>Output</span>
    </div>
  </div>
</div>

---

## CLI Approach

### Step 1: Generate Thumbnails for All Parts

```bash
mkdir -p ./catalog/thumbnails

raps object list cad-library --output json | jq -r '.[].key' | while read key; do
  URN=$(raps object urn cad-library "$key" --output plain)

  # Check if translation exists and is complete
  STATUS=$(raps translate manifest "$URN" 2>/dev/null | jq -r '.status // "none"')

  if [ "$STATUS" = "success" ]; then
    # Generate safe filename
    SAFE_NAME=$(echo "$key" | tr '/' '_' | sed 's/\.[^.]*$//')

    # Download thumbnail
    raps derivative thumbnail "$URN" --output "./catalog/thumbnails/${SAFE_NAME}.png"
    echo "Generated: ${SAFE_NAME}.png"
  else
    echo "Skipping (not translated): $key"
  fi
done
```

### Step 2: Extract Part Metadata

```bash
echo "[]" > ./catalog/parts.json

raps object list cad-library --output json | jq -r '.[].key' | while read key; do
  URN=$(raps object urn cad-library "$key" --output plain)

  STATUS=$(raps translate manifest "$URN" 2>/dev/null | jq -r '.status // "none"')

  if [ "$STATUS" = "success" ]; then
    SAFE_NAME=$(echo "$key" | tr '/' '_' | sed 's/\.[^.]*$//')

    # Get properties
    PROPS=$(raps derivative properties "$URN" --output json 2>/dev/null | jq '.[0].properties // {}')

    # Add to catalog
    jq --arg key "$key" \
       --arg name "$SAFE_NAME" \
       --argjson props "$PROPS" \
       '. += [{key: $key, name: $name, thumbnail: ($name + ".png"), properties: $props}]' \
       ./catalog/parts.json > ./catalog/parts.tmp.json

    mv ./catalog/parts.tmp.json ./catalog/parts.json
  fi
done
```

### Step 3: Generate HTML Catalog

```bash
cat > ./catalog/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
  <title>Parts Catalog</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
    .part { border: 1px solid #ddd; padding: 10px; text-align: center; border-radius: 8px; }
    .part img { max-width: 100%; height: 150px; object-fit: contain; }
    .part h3 { font-size: 14px; margin: 10px 0 5px; }
    .part p { font-size: 12px; color: #666; margin: 0; }
    .search { margin-bottom: 20px; padding: 10px; width: 100%; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Parts Catalog</h1>
  <input type="text" class="search" placeholder="Search parts..." onkeyup="filterParts(this.value)">
  <div class="grid" id="catalog"></div>

  <script>
    let parts = [];

    fetch('parts.json')
      .then(r => r.json())
      .then(data => {
        parts = data;
        renderParts(parts);
      });

    function renderParts(data) {
      const grid = document.getElementById('catalog');
      grid.innerHTML = data.map(p => `
        <div class="part">
          <img src="thumbnails/${p.thumbnail}" alt="${p.name}">
          <h3>${p.name}</h3>
          <p>${p.properties['Part Number'] || ''}</p>
          <p>${p.properties['Material'] || ''}</p>
        </div>
      `).join('');
    }

    function filterParts(query) {
      const filtered = parts.filter(p =>
        p.name.toLowerCase().includes(query.toLowerCase()) ||
        JSON.stringify(p.properties).toLowerCase().includes(query.toLowerCase())
      );
      renderParts(filtered);
    }
  </script>
</body>
</html>
EOF

echo "Catalog generated at ./catalog/index.html"
```

---

## CI/CD Pipeline

```yaml
# .github/workflows/catalog-generation.yml
name: Parts Catalog Generation

on:
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM
  workflow_dispatch:

jobs:
  generate-catalog:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install RAPS
        run: cargo install raps

      - name: Generate thumbnails
        env:
          APS_CLIENT_ID: ${{ secrets.APS_CLIENT_ID }}
          APS_CLIENT_SECRET: ${{ secrets.APS_CLIENT_SECRET }}
        run: |
          mkdir -p ./catalog/thumbnails

          raps object list cad-library --output json | jq -r '.[].key' | while read key; do
            URN=$(raps object urn cad-library "$key" --output plain)
            STATUS=$(raps translate manifest "$URN" 2>/dev/null | jq -r '.status // "none"')

            if [ "$STATUS" = "success" ]; then
              SAFE_NAME=$(echo "$key" | tr '/' '_' | sed 's/\.[^.]*$//')
              raps derivative thumbnail "$URN" --output "./catalog/thumbnails/${SAFE_NAME}.png" 2>/dev/null || true
            fi
          done

      - name: Generate metadata
        env:
          APS_CLIENT_ID: ${{ secrets.APS_CLIENT_ID }}
          APS_CLIENT_SECRET: ${{ secrets.APS_CLIENT_SECRET }}
        run: |
          echo "[]" > ./catalog/parts.json

          raps object list cad-library --output json | jq -r '.[].key' | while read key; do
            URN=$(raps object urn cad-library "$key" --output plain)
            STATUS=$(raps translate manifest "$URN" 2>/dev/null | jq -r '.status // "none"')

            if [ "$STATUS" = "success" ]; then
              SAFE_NAME=$(echo "$key" | tr '/' '_' | sed 's/\.[^.]*$//')
              PROPS=$(raps derivative properties "$URN" --output json 2>/dev/null | jq '.[0].properties // {}' || echo '{}')

              jq --arg key "$key" --arg name "$SAFE_NAME" --argjson props "$PROPS" \
                '. += [{key: $key, name: $name, thumbnail: ($name + ".png"), properties: $props}]' \
                ./catalog/parts.json > ./catalog/parts.tmp.json
              mv ./catalog/parts.tmp.json ./catalog/parts.json
            fi
          done

      - name: Generate HTML
        run: |
          # Generate index.html (see CLI section for template)
          cat > ./catalog/index.html << 'HTMLEOF'
          <!-- HTML template here -->
          HTMLEOF

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./catalog
```

### Pipeline Flow

<div class="not-prose my-6">
  <div class="flex flex-col sm:flex-row items-stretch gap-3">
    <div class="flex-1 border-2 border-blue-500/50 rounded-lg p-3 bg-blue-500/10">
      <div class="text-blue-400 font-semibold text-xs mb-2">Schedule/Manual</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">Daily 2 AM</div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">‚Üí</div>
    <div class="flex-1 border-2 border-purple-500/50 rounded-lg p-3 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-xs mb-2">Generation</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">List all parts</div>
        <div class="bg-slate-800 rounded px-2 py-1">Generate thumbnails</div>
        <div class="bg-slate-800 rounded px-2 py-1">Extract metadata</div>
        <div class="bg-slate-800 rounded px-2 py-1">Build HTML</div>
      </div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">‚Üí</div>
    <div class="flex-1 border-2 border-emerald-500/50 rounded-lg p-3 bg-emerald-500/10">
      <div class="text-emerald-400 font-semibold text-xs mb-2">Deploy</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">GitHub Pages</div>
    </div>
  </div>
</div>

---

## MCP Integration

### Generate Catalog

```
User: "Create a visual catalog of all parts in the CAD library"
```

<div class="not-prose my-6">
  <div class="bg-slate-900/50 rounded-lg border border-slate-700 p-4">
    <div class="flex gap-4 mb-4 text-xs font-semibold">
      <div class="text-blue-400">User</div>
      <div class="text-purple-400">AI Assistant</div>
      <div class="text-amber-400">RAPS MCP</div>
      <div class="text-emerald-400">APS Cloud</div>
    </div>
    <div class="space-y-2 text-xs">
      <div class="flex items-center gap-2">
        <div class="w-16 text-blue-400">User</div>
        <div class="flex-1 border-t border-dashed border-purple-500"></div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">Create parts catalog</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_object_list(bucket="cad-library")</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">List objects</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-emerald-400">APS</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">Object list</div>
      </div>
      <div class="flex items-center gap-2 pl-4 border-l-2 border-slate-600 ml-2">
        <div class="text-slate-500 italic">loop: For each part</div>
      </div>
      <div class="flex items-center gap-2 pl-6">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_derivative_thumbnail(urn)</div>
      </div>
      <div class="flex items-center gap-2 pl-6">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">Get thumbnail</div>
      </div>
      <div class="flex items-center gap-2 pl-6">
        <div class="w-16 text-emerald-400">APS</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">PNG data</div>
      </div>
      <div class="flex items-center gap-2 pl-6">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_derivative_properties(urn)</div>
      </div>
      <div class="flex items-center gap-2 pl-6">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">Get properties</div>
      </div>
      <div class="flex items-center gap-2 pl-6">
        <div class="w-16 text-emerald-400">APS</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">Properties JSON</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">Generate HTML catalog</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-blue-500"></div>
        <div class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded">Catalog ready with link</div>
      </div>
    </div>
  </div>
</div>

**AI Response:**
> Generated parts catalog with 45 items:
>
> **Catalog Statistics:**
> - Total parts: 45
> - With thumbnails: 43
> - With metadata: 45
>
> **Categories:**
> - Brackets: 12
> - Housings: 8
> - Shafts: 10
> - Gears: 15
>
> [View Catalog](./catalog/index.html)

### Search Catalog

```
User: "Find all aluminum parts in the catalog"
```

**AI Response:**
> Found 18 aluminum parts:
>
> | Part | Material | Weight |
> |------|----------|--------|
> | bracket-a | Aluminum 6061 | 0.45 kg |
> | housing-main | Aluminum 7075 | 2.3 kg |
> | cover-plate | Aluminum 6061 | 0.12 kg |
> | ... | ... | ... |

---

## Advanced Features

### Category Organization

```bash
# Organize by part type
cat ./catalog/parts.json | jq '
  group_by(.properties["Part Type"] // "Uncategorized") |
  map({
    category: .[0].properties["Part Type"] // "Uncategorized",
    count: length,
    parts: .
  })'
```

### Generate PDF Catalog

```bash
# Using wkhtmltopdf
wkhtmltopdf \
  --enable-local-file-access \
  --print-media-type \
  ./catalog/index.html \
  ./catalog/parts-catalog.pdf
```

### Incremental Updates

```bash
# Only update changed parts
LAST_RUN=$(cat .catalog-last-run 2>/dev/null || echo "1970-01-01")

raps object list cad-library --output json | \
  jq --arg since "$LAST_RUN" '.[] | select(.lastModified > $since)' | \
  jq -r '.key' | while read key; do
    echo "Updating: $key"
    # Generate thumbnail and metadata for this part
  done

date -Iseconds > .catalog-last-run
```

---

## Related

- [Multi-Format Batch Processing](/cookbook/cookbook-mfg-batch)
- [Design Iteration Tracking](/cookbook/cookbook-mfg-iterations)
- [Cookbook: Manufacturing](/cookbook/cookbook-manufacturing)
