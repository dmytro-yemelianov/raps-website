---
title: "Bill of Materials Extraction"
description: "Extract BOM data from CAD assemblies"
category: "manufacturing"
order: 22
icon: "ðŸ“‹"
---

# Bill of Materials Extraction

Extract Bill of Materials (BOM) data from Inventor and other CAD assemblies.

## Workflow Overview

<div class="not-prose my-8">
  <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
    <div class="border-2 border-blue-500/50 rounded-lg p-4 bg-blue-500/10">
      <div class="text-blue-400 font-semibold text-sm mb-3">Assembly Input</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">Inventor Assembly .iam</div>
    </div>
    <div class="border-2 border-purple-500/50 rounded-lg p-4 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-sm mb-3">Translation</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">Translate to SVF2</div>
    </div>
    <div class="border-2 border-purple-500/50 rounded-lg p-4 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-sm mb-3">Data Extraction</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Model Tree Hierarchy</div>
        <div class="bg-slate-800 rounded px-2 py-1">Properties Part Data</div>
      </div>
    </div>
    <div class="border-2 border-purple-500/50 rounded-lg p-4 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-sm mb-3">BOM Processing</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Flatten Hierarchy</div>
        <div class="bg-slate-800 rounded px-2 py-1">Aggregate Quantities</div>
        <div class="bg-slate-800 rounded px-2 py-1">Extract Properties</div>
      </div>
    </div>
    <div class="border-2 border-emerald-500/50 rounded-lg p-4 bg-emerald-500/10">
      <div class="text-emerald-400 font-semibold text-sm mb-3">Export Formats</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">CSV</div>
        <div class="bg-slate-800 rounded px-2 py-1">JSON</div>
        <div class="bg-slate-800 rounded px-2 py-1">Excel</div>
        <div class="bg-slate-800 rounded px-2 py-1">ERP Import</div>
      </div>
    </div>
  </div>
  <div class="flex justify-center mt-4">
    <div class="flex items-center gap-2 text-xs text-slate-500">
      <span>Input</span>
      <span class="text-slate-600">â†’</span>
      <span>Translate</span>
      <span class="text-slate-600">â†’</span>
      <span>Extract</span>
      <span class="text-slate-600">â†’</span>
      <span>Process</span>
      <span class="text-slate-600">â†’</span>
      <span>Export</span>
    </div>
  </div>
</div>

---

## CLI Approach

### Step 1: Translate Assembly

```bash
URN=$(raps object urn cad-library assembly.iam --output plain)
raps translate start "$URN" --format svf2 --wait
```

### Step 2: Extract Model Tree (Hierarchy)

```bash
raps derivative tree "$URN" --output json > bom-tree.json
```

### Step 3: Extract Part Properties

```bash
raps derivative properties "$URN" --output json > part-properties.json
```

### Step 4: Generate Flat BOM

```bash
# Flatten hierarchy to component list
cat bom-tree.json | jq '
  [.. | objects | select(.name != null and .objectid != null) |
   {name: .name, objectid: .objectid}]
' > bom-flat.json

# Count occurrences (quantities)
cat bom-flat.json | jq '
  group_by(.name) |
  map({part: .[0].name, quantity: length}) |
  sort_by(.part)'
```

### Step 5: Export to CSV

```bash
# Full BOM with properties
cat part-properties.json | jq -r '
  ["Part Number", "Description", "Material", "Mass"],
  (.[] | [
    .properties["Part Number"] // .name,
    .properties["Description"] // "",
    .properties["Material"] // "",
    .properties["Mass"] // ""
  ]) | @csv
' > bom.csv
```

---

## CI/CD Pipeline

```yaml
# .github/workflows/bom-extraction.yml
name: BOM Extraction Pipeline

on:
  workflow_dispatch:
    inputs:
      bucket:
        description: 'Bucket name'
        required: true
      assembly:
        description: 'Assembly filename'
        required: true

jobs:
  extract-bom:
    runs-on: ubuntu-latest
    steps:
      - name: Install RAPS
        run: cargo install raps

      - name: Extract BOM data
        env:
          APS_CLIENT_ID: ${{ secrets.APS_CLIENT_ID }}
          APS_CLIENT_SECRET: ${{ secrets.APS_CLIENT_SECRET }}
        run: |
          URN=$(raps object urn "${{ inputs.bucket }}" "${{ inputs.assembly }}" --output plain)

          mkdir -p ./bom-export

          # Extract tree and properties
          raps derivative tree "$URN" --output json > ./bom-export/tree.json
          raps derivative properties "$URN" --output json > ./bom-export/properties.json

      - name: Process BOM
        run: |
          # Create flat BOM with quantities
          cat ./bom-export/tree.json | jq '
            [.. | objects | select(.name != null)] |
            group_by(.name) |
            map({
              part: .[0].name,
              quantity: length,
              objectids: [.[].objectid]
            }) |
            sort_by(.part)
          ' > ./bom-export/bom-summary.json

          # Create CSV export
          echo "Part Number,Description,Material,Quantity" > ./bom-export/bom.csv

          cat ./bom-export/bom-summary.json | jq -r '.[] | .part' | while read part; do
            qty=$(cat ./bom-export/bom-summary.json | jq -r ".[] | select(.part == \"$part\") | .quantity")
            desc=$(cat ./bom-export/properties.json | jq -r ".[] | select(.name == \"$part\") | .properties.Description // \"\"" | head -1)
            mat=$(cat ./bom-export/properties.json | jq -r ".[] | select(.name == \"$part\") | .properties.Material // \"\"" | head -1)
            echo "\"$part\",\"$desc\",\"$mat\",$qty" >> ./bom-export/bom.csv
          done

      - name: Generate report
        run: |
          echo "# BOM Report" > ./bom-export/report.md
          echo "Assembly: ${{ inputs.assembly }}" >> ./bom-export/report.md
          echo "Date: $(date)" >> ./bom-export/report.md
          echo "" >> ./bom-export/report.md
          echo "## Summary" >> ./bom-export/report.md
          echo "- Unique parts: $(cat ./bom-export/bom-summary.json | jq 'length')" >> ./bom-export/report.md
          echo "- Total components: $(cat ./bom-export/bom-summary.json | jq '[.[].quantity] | add')" >> ./bom-export/report.md

      - name: Upload BOM artifacts
        uses: actions/upload-artifact@v4
        with:
          name: bom-export
          path: ./bom-export/
```

### Pipeline Flow

<div class="not-prose my-6">
  <div class="flex flex-col sm:flex-row items-stretch gap-3">
    <div class="flex-1 border-2 border-blue-500/50 rounded-lg p-3 bg-blue-500/10">
      <div class="text-blue-400 font-semibold text-xs mb-2">Manual Trigger</div>
      <div class="text-xs text-slate-300 bg-slate-800 rounded px-2 py-1">bucket + assembly</div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">â†’</div>
    <div class="flex-1 border-2 border-purple-500/50 rounded-lg p-3 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-xs mb-2">Extraction</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Get URN</div>
        <div class="bg-slate-800 rounded px-2 py-1">Extract Tree</div>
        <div class="bg-slate-800 rounded px-2 py-1">Extract Properties</div>
      </div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">â†’</div>
    <div class="flex-1 border-2 border-purple-500/50 rounded-lg p-3 bg-purple-500/10">
      <div class="text-purple-400 font-semibold text-xs mb-2">Processing</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">Flatten Hierarchy</div>
        <div class="bg-slate-800 rounded px-2 py-1">Calculate Quantities</div>
        <div class="bg-slate-800 rounded px-2 py-1">Merge Properties</div>
      </div>
    </div>
    <div class="hidden sm:flex items-center text-slate-600">â†’</div>
    <div class="flex-1 border-2 border-emerald-500/50 rounded-lg p-3 bg-emerald-500/10">
      <div class="text-emerald-400 font-semibold text-xs mb-2">Exports</div>
      <div class="space-y-1 text-xs text-slate-300">
        <div class="bg-slate-800 rounded px-2 py-1">bom.csv</div>
        <div class="bg-slate-800 rounded px-2 py-1">bom-summary.json</div>
        <div class="bg-slate-800 rounded px-2 py-1">report.md</div>
      </div>
    </div>
  </div>
</div>

---

## MCP Integration

### Extract BOM

```
User: "Extract the bill of materials from the gearbox assembly"
```

<div class="not-prose my-6">
  <div class="bg-slate-900/50 rounded-lg border border-slate-700 p-4">
    <div class="flex gap-4 mb-4 text-xs font-semibold">
      <div class="text-blue-400">User</div>
      <div class="text-purple-400">AI Assistant</div>
      <div class="text-amber-400">RAPS MCP</div>
      <div class="text-emerald-400">APS Cloud</div>
    </div>
    <div class="space-y-2 text-xs">
      <div class="flex items-center gap-2">
        <div class="w-16 text-blue-400">User</div>
        <div class="flex-1 border-t border-dashed border-purple-500"></div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">Extract BOM from gearbox assembly</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_object_urn(bucket, "gearbox.iam")</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-purple-500"></div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">URN</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_derivative_tree(urn)</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">Get model tree</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-emerald-400">APS</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">Tree JSON</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">aps_derivative_properties(urn)</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-amber-400">MCP</div>
        <div class="flex-1 border-t border-dashed border-emerald-500"></div>
        <div class="bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded">Get properties</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-emerald-400">APS</div>
        <div class="flex-1 border-t border-dashed border-amber-500"></div>
        <div class="bg-amber-500/20 text-amber-300 px-2 py-1 rounded">Properties JSON</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="bg-purple-500/20 text-purple-300 px-2 py-1 rounded">Process and aggregate BOM</div>
      </div>
      <div class="flex items-center gap-2">
        <div class="w-16 text-purple-400">AI</div>
        <div class="flex-1 border-t border-dashed border-blue-500"></div>
        <div class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded">BOM table with quantities</div>
      </div>
    </div>
  </div>
</div>

**AI Response:**
> Bill of Materials for Gearbox Assembly:
>
> | Part Number | Description | Material | Qty |
> |-------------|-------------|----------|-----|
> | GBX-001 | Housing | Aluminum 6061 | 1 |
> | GBX-002 | Input Shaft | Steel 4140 | 1 |
> | GBX-003 | Output Shaft | Steel 4140 | 1 |
> | GBX-010 | Gear 32T | Steel 8620 | 2 |
> | GBX-011 | Gear 48T | Steel 8620 | 1 |
> | GBX-020 | Bearing 6205 | - | 4 |
> | GBX-030 | Seal | Nitrile | 2 |
>
> **Total:** 7 unique parts, 12 components

### Compare BOMs

```
User: "Compare the BOM of v1 and v2 of the assembly"
```

**AI Response:**
> BOM Comparison: Gearbox v1 vs v2
>
> **Added in v2:**
> - GBX-035 Gasket (qty: 1)
> - GBX-040 Breather Plug (qty: 1)
>
> **Removed from v1:**
> - GBX-025 O-Ring (was qty: 2)
>
> **Quantity Changes:**
> - GBX-020 Bearing: 4 â†’ 6 (+2)
>
> **Summary:** v2 has 9 unique parts (was 8)

---

## Advanced BOM Processing

### Indented BOM (Multi-Level)

```bash
# Generate indented BOM showing hierarchy
cat bom-tree.json | jq '
  def indent(level):
    if level > 0 then ("  " * level) + "â””â”€ " else "" end;

  def walk(node; level):
    (indent(level) + node.name),
    (node.children[]? | walk(.; level + 1));

  walk(.; 0)
' -r
```

### BOM with Cost Rollup

```bash
# Assuming properties include cost
cat part-properties.json | jq '
  group_by(.name) |
  map({
    part: .[0].name,
    quantity: length,
    unit_cost: (.[0].properties["Unit Cost"] // 0 | tonumber),
    extended_cost: (length * (.[0].properties["Unit Cost"] // 0 | tonumber))
  }) |
  . + [{
    part: "TOTAL",
    quantity: ([.[].quantity] | add),
    unit_cost: null,
    extended_cost: ([.[].extended_cost] | add)
  }]'
```

### Export for ERP System

```bash
# Format for ERP import (SAP-style)
cat bom-summary.json | jq -r '
  .[] | [
    "BOM",                    # Record type
    "GEARBOX-ASM",           # Parent
    .part,                    # Component
    .quantity,                # Quantity
    "EA",                     # UOM
    "1"                       # BOM level
  ] | @csv
' > erp-import.csv
```

---

## Related

- [CAD Translation Pipeline](/cookbook/cookbook-mfg-translation)
- [Design Iteration Tracking](/cookbook/cookbook-mfg-iterations)
- [Cookbook: Manufacturing](/cookbook/cookbook-manufacturing)
