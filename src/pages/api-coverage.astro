---
import BaseLayout from '../layouts/BaseLayout.astro';

// API Coverage data
const services = [
  {
    name: 'Authentication',
    icon: 'ðŸ”',
    color: 'from-emerald-500/20 to-emerald-900/20',
    borderColor: 'border-emerald-500/30',
    features: [
      { name: '2-legged OAuth (Client Credentials)', command: 'auth test', status: 'full' },
      { name: '3-legged OAuth (Authorization Code)', command: 'auth login', status: 'full' },
      { name: 'Device Code Flow', command: 'auth login --device', status: 'full' },
      { name: 'Token Inspection', command: 'auth inspect-token', status: 'full' },
      { name: 'User Profile', command: 'auth whoami', status: 'full' },
    ]
  },
  {
    name: 'Object Storage (OSS)',
    icon: 'ðŸ“¦',
    color: 'from-blue-500/20 to-blue-900/20',
    borderColor: 'border-blue-500/30',
    features: [
      { name: 'Bucket CRUD', command: 'bucket create/list/delete', status: 'full' },
      { name: 'Object Upload', command: 'object upload', status: 'full' },
      { name: 'Resumable Uploads', command: 'object upload (auto)', status: 'full' },
      { name: 'Batch Upload', command: 'object upload --batch', status: 'full' },
      { name: 'Object Download', command: 'object download', status: 'full' },
      { name: 'Signed URLs', command: 'object signed-url', status: 'full' },
      { name: 'Object URN', command: 'object urn', status: 'full' },
    ]
  },
  {
    name: 'Model Derivative',
    icon: 'ðŸ”„',
    color: 'from-purple-500/20 to-purple-900/20',
    borderColor: 'border-purple-500/30',
    features: [
      { name: 'Translation Jobs', command: 'translate start', status: 'full' },
      { name: 'Status Polling', command: 'translate status --wait', status: 'full' },
      { name: 'Manifest/Metadata', command: 'translate manifest', status: 'full' },
      { name: 'Derivative Download', command: 'translate download', status: 'full' },
      { name: 'SVF/SVF2 Output', command: '--format svf/svf2', status: 'full' },
      { name: 'OBJ/STL/STEP Export', command: '--format obj/stl/step', status: 'full' },
      { name: 'Thumbnail Generation', command: '--format thumbnail', status: 'full' },
    ]
  },
  {
    name: 'Data Management',
    icon: 'ðŸ—ï¸',
    color: 'from-amber-500/20 to-amber-900/20',
    borderColor: 'border-amber-500/30',
    features: [
      { name: 'Hub Listing', command: 'hub list', status: 'full' },
      { name: 'Project Listing', command: 'project list', status: 'full' },
      { name: 'Folder Operations', command: 'folder list/create', status: 'full' },
      { name: 'Item Operations', command: 'item list/versions', status: 'full' },
      { name: 'BIM 360 Support', command: '(integrated)', status: 'full' },
      { name: 'ACC Support', command: '(integrated)', status: 'full' },
      { name: 'Object Binding', command: 'item bind', status: 'full' },
    ]
  },
  {
    name: 'ACC Issues',
    icon: 'ðŸ”§',
    color: 'from-red-500/20 to-red-900/20',
    borderColor: 'border-red-500/30',
    features: [
      { name: 'Issue CRUD', command: 'issue list/create/edit', status: 'full' },
      { name: 'Issue Types', command: 'issue types', status: 'full' },
      { name: 'Comments', command: 'issue comment', status: 'full' },
      { name: 'Attachments', command: 'issue attachment', status: 'full' },
      { name: 'State Transitions', command: 'issue transition', status: 'full' },
    ]
  },
  {
    name: 'ACC RFIs',
    icon: 'â“',
    color: 'from-orange-500/20 to-orange-900/20',
    borderColor: 'border-orange-500/30',
    features: [
      { name: 'RFI CRUD', command: 'rfi list/create/update', status: 'full' },
      { name: 'RFI Responses', command: 'rfi answer', status: 'full' },
      { name: 'RFI Status Tracking', command: 'rfi status', status: 'full' },
    ]
  },
  {
    name: 'ACC Extended',
    icon: 'ðŸ“‹',
    color: 'from-teal-500/20 to-teal-900/20',
    borderColor: 'border-teal-500/30',
    features: [
      { name: 'Assets', command: 'acc asset list/...', status: 'full' },
      { name: 'Submittals', command: 'acc submittal list/...', status: 'full' },
      { name: 'Checklists', command: 'acc checklist list/...', status: 'full' },
      { name: 'Checklist Templates', command: 'acc checklist templates', status: 'full' },
    ]
  },
  {
    name: 'Design Automation',
    icon: 'âš™ï¸',
    color: 'from-indigo-500/20 to-indigo-900/20',
    borderColor: 'border-indigo-500/30',
    features: [
      { name: 'Engine Discovery', command: 'da engine list', status: 'full' },
      { name: 'Activity Management', command: 'da activity list/create', status: 'partial' },
      { name: 'App Bundles', command: 'da appbundle list/create', status: 'partial' },
      { name: 'Work Items', command: 'da workitem create/status', status: 'partial' },
      { name: 'Result Download', command: 'da workitem download', status: 'full' },
    ]
  },
  {
    name: 'Reality Capture',
    icon: 'ðŸ“¸',
    color: 'from-pink-500/20 to-pink-900/20',
    borderColor: 'border-pink-500/30',
    features: [
      { name: 'Photoscene CRUD', command: 'rc photoscene create/delete', status: 'full' },
      { name: 'Photo Upload', command: 'rc photoscene upload', status: 'full' },
      { name: 'Processing', command: 'rc photoscene process', status: 'full' },
      { name: 'Result Download', command: 'rc photoscene download', status: 'full' },
    ]
  },
  {
    name: 'Webhooks',
    icon: 'ðŸ””',
    color: 'from-cyan-500/20 to-cyan-900/20',
    borderColor: 'border-cyan-500/30',
    features: [
      { name: 'Subscription CRUD', command: 'webhook create/delete/list', status: 'full' },
      { name: 'Event Discovery', command: 'webhook events', status: 'full' },
      { name: 'Endpoint Testing', command: 'webhook test', status: 'new' },
    ]
  },
  {
    name: 'MCP Server',
    icon: 'ðŸ¤–',
    color: 'from-rapeseed-500/20 to-rapeseed-900/20',
    borderColor: 'border-rapeseed-500/30',
    features: [
      { name: 'AI Tool Integration', command: 'serve', status: 'new' },
      { name: 'Authentication Tools', command: 'auth_test, auth_status', status: 'new' },
      { name: 'OSS Tools', command: 'bucket_*, object_*', status: 'new' },
      { name: 'Translation Tools', command: 'translate_*', status: 'new' },
      { name: 'Data Management Tools', command: 'hub_list, project_list', status: 'new' },
    ]
  },
];

const statusLabels = {
  full: { label: 'Full', class: 'bg-emerald-500/20 text-emerald-400 border-emerald-500/30' },
  partial: { label: 'Partial', class: 'bg-amber-500/20 text-amber-400 border-amber-500/30' },
  new: { label: 'New', class: 'bg-purple-500/20 text-purple-400 border-purple-500/30' },
  planned: { label: 'Planned', class: 'bg-slate-500/20 text-slate-400 border-slate-500/30' },
};

// Calculate stats
const totalFeatures = services.reduce((acc, s) => acc + s.features.length, 0);
const fullFeatures = services.reduce((acc, s) => acc + s.features.filter(f => f.status === 'full').length, 0);
const newFeatures = services.reduce((acc, s) => acc + s.features.filter(f => f.status === 'new').length, 0);
---

<BaseLayout title="API Coverage" description="Comprehensive overview of APS API coverage in RAPS CLI">
  <section class="py-16 sm:py-24">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <!-- Header -->
      <div class="text-center mb-16">
        <span class="inline-flex items-center gap-2 px-4 py-1.5 bg-slate-800/50 border border-slate-700/50 rounded-full text-sm text-slate-300 mb-6">
          <span class="w-2 h-2 bg-emerald-400 rounded-full"></span>
          {services.length} API Services Supported
        </span>
        <h1 class="text-4xl sm:text-5xl font-display font-bold text-white mb-4">
          APS API Coverage
        </h1>
        <p class="text-xl text-slate-400 max-w-2xl mx-auto mb-6">
          Comprehensive implementation of<br class="hidden sm:inline" />
          Autodesk Platform Services APIs in RAPS CLI
        </p>
        
        <!-- GitHub Buttons -->
        <div class="flex flex-wrap justify-center gap-3">
          <a
            href="https://github.com/dmytro-yemelianov/raps"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white text-sm font-medium rounded-lg border border-slate-700 transition-colors"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z" />
            </svg>
            <svg class="w-4 h-4 text-amber-400" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
            </svg>
            Star
          </a>
          <a
            href="https://github.com/dmytro-yemelianov/raps/fork"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white text-sm font-medium rounded-lg border border-slate-700 transition-colors"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M5.559 8.855c.166 1.183.789 3.207 3.087 4.079C11 13.829 11 14.534 11 15v.163c-1.44.434-2.5 1.757-2.5 3.337 0 1.93 1.57 3.5 3.5 3.5s3.5-1.57 3.5-3.5c0-1.58-1.06-2.903-2.5-3.337V15c0-.466 0-1.171 2.354-2.065 2.298-.872 2.921-2.896 3.087-4.079C19.912 8.441 21 7.102 21 5.5 21 3.57 19.43 2 17.5 2S14 3.57 14 5.5c0 1.552 1.022 2.855 2.424 3.313-.146.735-.565 1.791-1.778 2.252-1.192.452-2.053.953-2.646 1.536-.593-.583-1.453-1.084-2.646-1.536-1.213-.461-1.632-1.517-1.778-2.252C8.978 8.355 10 7.052 10 5.5 10 3.57 8.43 2 6.5 2S3 3.57 3 5.5c0 1.602 1.088 2.941 2.559 3.355zM17.5 4c.827 0 1.5.673 1.5 1.5S18.327 7 17.5 7 16 6.327 16 5.5 16.673 4 17.5 4zm-11 0C7.327 4 8 4.673 8 5.5S7.327 7 6.5 7 5 6.327 5 5.5 5.673 4 6.5 4zm5.5 16c-.827 0-1.5-.673-1.5-1.5S11.173 17 12 17s1.5.673 1.5 1.5S12.827 20 12 20z"/>
            </svg>
            Fork
          </a>
          <a
            href="https://github.com/dmytro-yemelianov/raps/issues"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white text-sm font-medium rounded-lg border border-slate-700 transition-colors"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
            Issues
          </a>
        </div>
      </div>
      
      <!-- Stats -->
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-16">
        <div class="p-6 bg-slate-900/50 border border-slate-800 rounded-xl text-center">
          <div class="text-3xl font-bold text-white mb-1">{services.length}</div>
          <div class="text-sm text-slate-400">API Services</div>
        </div>
        <div class="p-6 bg-slate-900/50 border border-slate-800 rounded-xl text-center">
          <div class="text-3xl font-bold text-emerald-400 mb-1">{totalFeatures}</div>
          <div class="text-sm text-slate-400">Total Features</div>
        </div>
        <div class="p-6 bg-slate-900/50 border border-slate-800 rounded-xl text-center">
          <div class="text-3xl font-bold text-emerald-400 mb-1">{fullFeatures}</div>
          <div class="text-sm text-slate-400">Full Coverage</div>
        </div>
        <div class="p-6 bg-slate-900/50 border border-slate-800 rounded-xl text-center">
          <div class="text-3xl font-bold text-purple-400 mb-1">{newFeatures}</div>
          <div class="text-sm text-slate-400">New in v3.0</div>
        </div>
      </div>
      
      <!-- OpenAPI Reference -->
      <div class="mb-12 p-6 bg-gradient-to-r from-slate-900 to-slate-800 border border-slate-700 rounded-xl">
        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
          <div class="flex items-start gap-4">
            <div class="p-2 bg-emerald-500/10 rounded-lg shrink-0">
              <svg class="w-6 h-6 text-emerald-400" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-white mb-1">Built on Official OpenAPI Specs</h3>
              <p class="text-sm text-slate-400">
                RAPS implements APIs based on the official 
                <a 
                  href="https://github.com/autodesk-platform-services/aps-sdk-openapi" 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="text-emerald-400 hover:text-emerald-300 underline underline-offset-2"
                >
                  APS SDK OpenAPI Specifications
                </a>
                maintained by Autodesk.
              </p>
            </div>
          </div>
          <a
            href="https://github.com/autodesk-platform-services/aps-sdk-openapi"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm font-medium rounded-lg transition-colors shrink-0"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z" />
            </svg>
            View OpenAPI Specs
          </a>
        </div>
      </div>
      
      <!-- Legend -->
      <div class="flex flex-wrap justify-center gap-4 mb-12">
        {Object.entries(statusLabels).map(([key, value]) => (
          <div class="flex items-center gap-2">
            <span class:list={["px-2 py-0.5 text-xs font-medium rounded border", value.class]}>
              {value.label}
            </span>
            <span class="text-sm text-slate-500">
              {key === 'full' && 'â€” All major endpoints implemented'}
              {key === 'partial' && 'â€” Basic operations supported'}
              {key === 'new' && 'â€” Added in v3.0.0'}
              {key === 'planned' && 'â€” On the roadmap'}
            </span>
          </div>
        ))}
      </div>
      
      <!-- Service Cards Grid -->
      <div class="grid md:grid-cols-2 gap-6">
        {services.map((service) => (
          <div class:list={[
            "p-6 rounded-xl border bg-gradient-to-br",
            service.color,
            service.borderColor
          ]}>
            <div class="flex items-center gap-3 mb-4">
              <span class="text-2xl">{service.icon}</span>
              <h2 class="text-xl font-bold text-white">{service.name}</h2>
            </div>
            
            <div class="space-y-2">
              {service.features.map((feature) => (
                <div class="flex items-center justify-between gap-4 py-2 border-b border-slate-700/50 last:border-0">
                  <div class="flex-1 min-w-0">
                    <div class="text-sm text-white font-medium truncate">{feature.name}</div>
                    <code class="text-xs text-slate-400 font-mono">{feature.command}</code>
                  </div>
                  <span class:list={[
                    "px-2 py-0.5 text-xs font-medium rounded border shrink-0",
                    statusLabels[feature.status].class
                  ]}>
                    {statusLabels[feature.status].label}
                  </span>
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
      
      <!-- Full Table (for larger view) -->
      <div class="mt-16">
        <h2 class="text-2xl font-display font-bold text-white mb-6 text-center">Complete Feature Matrix</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-sm">
            <thead>
              <tr class="border-b border-slate-700">
                <th class="text-left py-3 px-4 font-semibold text-white">Service</th>
                <th class="text-left py-3 px-4 font-semibold text-white">Feature</th>
                <th class="text-left py-3 px-4 font-semibold text-white">Command</th>
                <th class="text-center py-3 px-4 font-semibold text-white">Status</th>
              </tr>
            </thead>
            <tbody>
              {services.map((service) => (
                service.features.map((feature, idx) => (
                  <tr class="border-b border-slate-800 hover:bg-slate-800/30 transition-colors">
                    <td class="py-3 px-4 text-slate-300">
                      {idx === 0 ? (
                        <span class="flex items-center gap-2">
                          <span>{service.icon}</span>
                          <span class="font-medium">{service.name}</span>
                        </span>
                      ) : ''}
                    </td>
                    <td class="py-3 px-4 text-slate-300">{feature.name}</td>
                    <td class="py-3 px-4">
                      <code class="text-xs text-rapeseed-400 font-mono bg-slate-800/50 px-1.5 py-0.5 rounded">
                        {feature.command}
                      </code>
                    </td>
                    <td class="py-3 px-4 text-center">
                      <span class:list={[
                        "px-2 py-0.5 text-xs font-medium rounded border",
                        statusLabels[feature.status].class
                      ]}>
                        {statusLabels[feature.status].label}
                      </span>
                    </td>
                  </tr>
                ))
              ))}
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- CTA -->
      <div class="mt-16 text-center">
        <p class="text-slate-400 mb-6">
          Missing a feature you need? Let us know!
        </p>
        <a
          href="https://github.com/dmytro-yemelianov/raps/issues/new"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 px-6 py-3 bg-slate-800 hover:bg-slate-700 text-white font-medium rounded-lg transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z" />
          </svg>
          Request a Feature
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

