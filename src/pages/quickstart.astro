---
import BaseLayout from '../layouts/BaseLayout.astro';

const steps = [
  {
    number: '01',
    title: 'Install RAPS',
    description: 'Choose your preferred installation method',
    tabs: [
      {
        id: 'cargo',
        label: 'Cargo',
        icon: 'ü¶Ä',
        commands: ['cargo install raps'],
        note: 'Requires Rust 1.70+ (rustup.rs)',
      },
      {
        id: 'homebrew',
        label: 'Homebrew',
        icon: 'üç∫',
        commands: [
          '# macOS & Linux',
          'brew install dmytro-yemelianov/tap/raps',
        ],
        note: 'Recommended for macOS users',
      },
      {
        id: 'scoop',
        label: 'Scoop',
        icon: 'ü•Ñ',
        commands: [
          '# Windows',
          'scoop bucket add raps https://github.com/dmytro-yemelianov/scoop-bucket',
          'scoop install raps',
        ],
        note: 'Recommended for Windows users',
      },
      {
        id: 'docker',
        label: 'Docker',
        icon: 'üê≥',
        commands: [
          '# DockerHub',
          'docker pull dmytroyemelianov/raps',
          '',
          '# GitHub Container Registry',
          'docker pull ghcr.io/dmytro-yemelianov/raps',
        ],
        note: 'Best for containerized environments',
      },
      {
        id: 'action',
        label: 'GitHub Action',
        icon: '‚ö°',
        commands: [
          '# In your .github/workflows/*.yml',
          '- uses: dmytro-yemelianov/raps-action@v1',
          '  with:',
          '    command: "auth test"',
          '    client-id: ${{ secrets.APS_CLIENT_ID }}',
          '    client-secret: ${{ secrets.APS_CLIENT_SECRET }}',
        ],
        note: 'Best for GitHub Actions CI/CD',
      },
      {
        id: 'windows',
        label: 'Windows',
        icon: '‚äû',
        commands: [
          '# Download from GitHub releases',
          'Invoke-WebRequest -Uri "https://github.com/dmytro-yemelianov/raps/releases/latest/download/raps-windows-x64.zip" -OutFile raps.zip',
          'Expand-Archive raps.zip -DestinationPath $env:USERPROFILE\\bin',
          '$env:PATH += ";$env:USERPROFILE\\bin"',
        ],
      },
      {
        id: 'macos',
        label: 'macOS',
        icon: 'üçé',
        commands: [
          '# Apple Silicon',
          'curl -LO https://github.com/dmytro-yemelianov/raps/releases/latest/download/raps-macos-arm64.tar.gz',
          'tar -xzf raps-macos-arm64.tar.gz',
          'sudo mv raps /usr/local/bin/',
        ],
      },
      {
        id: 'linux',
        label: 'Linux',
        icon: 'üêß',
        commands: [
          'curl -LO https://github.com/dmytro-yemelianov/raps/releases/latest/download/raps-linux-x64.tar.gz',
          'tar -xzf raps-linux-x64.tar.gz',
          'sudo mv raps /usr/local/bin/',
          'chmod +x /usr/local/bin/raps',
        ],
      },
    ],
  },
  {
    number: '02',
    title: 'Configure Credentials',
    description: 'Set up your APS application credentials',
    content: `
      <p class="text-slate-400 mb-4">Get your credentials from the <a href="https://aps.autodesk.com/myapps" target="_blank" rel="noopener noreferrer" class="text-primary-400 hover:text-primary-300 underline">APS Developer Portal</a>.</p>
      <div class="space-y-4">
        <div>
          <h4 class="text-sm font-semibold text-white mb-2">Option 1: Environment Variables</h4>
          <div class="bg-slate-900 rounded-lg border border-slate-800 p-4 font-mono text-sm">
            <div class="text-slate-500"># PowerShell</div>
            <div><span class="text-green-400">$env:</span>APS_CLIENT_ID = <span class="text-amber-400">"your_client_id"</span></div>
            <div><span class="text-green-400">$env:</span>APS_CLIENT_SECRET = <span class="text-amber-400">"your_client_secret"</span></div>
          </div>
        </div>
        <div>
          <h4 class="text-sm font-semibold text-white mb-2">Option 2: .env File</h4>
          <div class="bg-slate-900 rounded-lg border border-slate-800 p-4 font-mono text-sm">
            <div class="text-slate-500"># Create .env in your project directory</div>
            <div>APS_CLIENT_ID=your_client_id</div>
            <div>APS_CLIENT_SECRET=your_client_secret</div>
          </div>
        </div>
        <div>
          <h4 class="text-sm font-semibold text-white mb-2">Option 3: RAPS Profile</h4>
          <div class="bg-slate-900 rounded-lg border border-slate-800 p-4 font-mono text-sm">
            <div class="text-green-400">$ <span class="text-white">raps config profile create production</span></div>
            <div class="text-green-400">$ <span class="text-white">raps config set client_id "your_client_id"</span></div>
            <div class="text-green-400">$ <span class="text-white">raps config set client_secret "your_client_secret"</span></div>
          </div>
        </div>
      </div>
    `,
  },
  {
    number: '03',
    title: 'Verify Authentication',
    description: 'Test your connection to APS',
    code: [
      { prompt: '$', cmd: 'raps auth test', output: '‚úì 2-legged authentication successful' },
      { prompt: '$', cmd: 'raps auth login', output: '‚úì Logged in as john.doe@company.com', note: 'Opens browser for 3-legged OAuth' },
      { prompt: '$', cmd: 'raps auth whoami', output: 'Name: John Doe\nEmail: john.doe@company.com' },
    ],
  },
  {
    number: '04',
    title: 'Your First Workflow',
    description: 'Upload a model and translate it',
    code: [
      { prompt: '$', cmd: 'raps bucket create', output: 'Created bucket: my-bucket-abc123' },
      { prompt: '$', cmd: 'raps object upload my-bucket model.rvt', output: 'Uploading model.rvt... ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100%\nURN: dXJuOmFkc2sub2...' },
      { prompt: '$', cmd: 'raps translate start $URN --format svf2 --wait', output: 'Translation in progress... done (47s)\n‚úì Translation complete' },
      { prompt: '$', cmd: 'raps translate manifest $URN -o json', output: '{ "status": "success", "derivatives": [...] }' },
    ],
  },
];

const nextSteps = [
  { href: '/docs/cli/commands', label: 'Command Reference', icon: 'üìñ' },
  { href: '/docs/guides/cicd', label: 'CI/CD Integration', icon: 'üîÑ' },
  { href: '/docs/guides/pipelines', label: 'Pipeline Automation', icon: '‚ö°' },
  { href: '/blog', label: 'Tutorials & Guides', icon: 'üìù' },
];
---

<BaseLayout 
  title="Quick Start" 
  description="Get started with RAPS in 5 minutes. Install, configure, and run your first APS automation."
>
  <section class="py-16 sm:py-24">
    <div class="max-w-4xl mx-auto px-4 sm:px-6">
      <!-- Header -->
      <div class="mb-16 text-center">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 bg-rapeseed-500/10 border border-rapeseed-500/20 rounded-full text-sm text-rapeseed-400 mb-6">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          5 minute setup
        </div>
        <h1 class="text-4xl sm:text-5xl font-display font-black text-white mb-6">
          Quick Start
        </h1>
        <p class="text-xl text-slate-400 max-w-2xl mx-auto">
          From zero to automating APS in 5 minutes. Let's get you up and running.
        </p>
      </div>
      
      <!-- Steps -->
      <div class="space-y-16">
        {steps.map((step, index) => (
          <div class="relative">
            {/* Step connector */}
            {index < steps.length - 1 && (
              <div class="absolute left-8 top-20 bottom-0 w-0.5 bg-gradient-to-b from-slate-700 to-transparent hidden md:block"></div>
            )}
            
            <div class="flex gap-6">
              {/* Step number */}
              <div class="hidden md:flex flex-shrink-0 w-16 h-16 bg-gradient-to-br from-rapeseed-500/20 to-primary-500/20 border border-slate-700 rounded-2xl items-center justify-center">
                <span class="text-2xl font-display font-black text-white">{step.number}</span>
              </div>
              
              {/* Content */}
              <div class="flex-1">
                <div class="mb-4">
                  <span class="inline-block md:hidden text-sm text-rapeseed-400 font-mono mb-2">Step {step.number}</span>
                  <h2 class="text-2xl font-display font-bold text-white mb-2">{step.title}</h2>
                  <p class="text-slate-400">{step.description}</p>
                </div>
                
                {/* Installation tabs */}
                {step.tabs && (
                  <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden" data-step-tabs>
                    <div class="flex border-b border-slate-800 overflow-x-auto">
                      {step.tabs.map((tab, tabIndex) => (
                        <button
                          class:list={[
                            "px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-2",
                            tabIndex === 0 ? "bg-slate-800 text-white" : "text-slate-400 hover:text-white hover:bg-slate-800/50"
                          ]}
                          data-tab={tab.id}
                        >
                          <span>{tab.icon}</span>
                          {tab.label}
                        </button>
                      ))}
                    </div>
                    {step.tabs.map((tab, tabIndex) => (
                      <div 
                        class:list={["p-6", tabIndex !== 0 && "hidden"]}
                        data-tab-content={tab.id}
                      >
                        <div class="font-mono text-sm space-y-1">
                          {tab.commands.map(cmd => (
                            <div class={cmd.startsWith('#') ? 'text-slate-500' : ''}>
                              {!cmd.startsWith('#') && <span class="text-green-400">$ </span>}
                              <span class="text-white">{cmd}</span>
                            </div>
                          ))}
                        </div>
                        {tab.note && (
                          <p class="mt-4 text-sm text-slate-500">{tab.note}</p>
                        )}
                      </div>
                    ))}
                  </div>
                )}
                
                {/* HTML content */}
                {step.content && (
                  <div set:html={step.content} />
                )}
                
                {/* Code examples */}
                {step.code && (
                  <div class="bg-slate-900 rounded-xl border border-slate-800 p-6 font-mono text-sm space-y-4">
                    {step.code.map(line => (
                      <div>
                        <div class="text-green-400">{line.prompt} <span class="text-white">{line.cmd}</span></div>
                        {line.note && <div class="text-slate-500 text-xs mt-1"># {line.note}</div>}
                        <div class="text-slate-400 mt-1 whitespace-pre-wrap">{line.output}</div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          </div>
        ))}
      </div>
      
      <!-- Success message -->
      <div class="mt-16 p-8 bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20 rounded-xl text-center">
        <div class="text-4xl mb-4">üéâ</div>
        <h3 class="text-xl font-display font-bold text-white mb-2">You're all set!</h3>
        <p class="text-slate-400 mb-6">
          You've successfully set up RAPS and translated your first model.
        </p>
        <a 
          href="https://github.com/dmytro-yemelianov/raps"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 px-6 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z" />
          </svg>
          Star RAPS on GitHub
        </a>
      </div>
      
      <!-- Next steps -->
      <div class="mt-16">
        <h3 class="text-xl font-display font-bold text-white mb-6">Next Steps</h3>
        <div class="grid sm:grid-cols-2 gap-4">
          {nextSteps.map(item => (
            <a 
              href={item.href}
              class="flex items-center gap-4 p-4 bg-slate-900/50 border border-slate-800 rounded-xl hover:border-primary-500/50 hover:bg-slate-900 transition-all group"
            >
              <span class="text-2xl">{item.icon}</span>
              <span class="text-white font-medium group-hover:text-primary-400 transition-colors">{item.label}</span>
              <svg class="w-4 h-4 text-slate-500 group-hover:text-primary-400 ml-auto transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          ))}
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  // Tab switching functionality
  document.querySelectorAll('[data-step-tabs]').forEach(tabContainer => {
    const buttons = tabContainer.querySelectorAll('[data-tab]');
    const contents = tabContainer.querySelectorAll('[data-tab-content]');
    
    buttons.forEach(button => {
      button.addEventListener('click', () => {
        const tabId = button.getAttribute('data-tab');
        
        // Update button styles
        buttons.forEach(btn => {
          btn.classList.remove('bg-slate-800', 'text-white');
          btn.classList.add('text-slate-400');
        });
        button.classList.add('bg-slate-800', 'text-white');
        button.classList.remove('text-slate-400');
        
        // Show/hide content
        contents.forEach(content => {
          if (content.getAttribute('data-tab-content') === tabId) {
            content.classList.remove('hidden');
          } else {
            content.classList.add('hidden');
          }
        });
      });
    });
  });
</script>

